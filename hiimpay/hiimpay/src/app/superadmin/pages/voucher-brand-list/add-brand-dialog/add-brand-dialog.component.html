<h2 class="dialog-title">New Brand</h2>
<p class="subtitle">Choose your preferred onboarding method for brands</p>

<div class="tabs">
  <button class="tab" [class.active]="activeTab==='excel'" (click)="switchTab('excel')">
    Excel Upload
  </button>
  <button class="tab" [class.active]="activeTab==='api'" (click)="switchTab('api')">
    API Integration
  </button>
</div>

<div *ngIf="activeTab==='excel'" class="tab-content">
  <button type="button" class="download-btn">
    Download Template
  </button>

  <div class="upload-box">
    <input
      type="file"
      hidden
      #fileInput
      accept=".xlsx,.xls"
      (change)="onFileSelect($event)"
    />

    <div class="drop-zone" (click)="fileInput.click()">
      <div class="icon">Upload</div>
      <p>Drag and drop file here</p>
      <span>or click to browse</span>
    </div>
  </div>
</div>

<div *ngIf="activeTab==='api'" class="tab-content">
  <div class="api-box">
    <h4>API Integration</h4>
    <p>Select one provider, configure auth and data endpoints, then save/pull.</p>
  </div>

  <label>API Profile</label>
  <select [ngModel]="selectedApiProfileId" (ngModelChange)="onApiProfileChange($event)">
    <option *ngFor="let profile of apiProfiles" [ngValue]="profile.id">{{ profile.name }}</option>
  </select>
  <small class="hint">{{ selectedApiProfileDescription }}</small>

  <div class="api-endpoint-card" *ngFor="let endpoint of apiEndpoints; let i = index">
    <div class="api-endpoint-header">
      <strong>{{ endpoint.type === 'auth' ? 'Auth API' : 'Data API' }}</strong>
      <button type="button" class="cancel small-btn" (click)="removeEndpoint(i)">Remove</button>
    </div>

    <div class="grid-2">
      <div>
        <label>Endpoint Name</label>
        <input type="text" [(ngModel)]="endpoint.name">
      </div>
      <div>
        <label>Method</label>
        <select [(ngModel)]="endpoint.method">
          <option value="GET">GET</option>
          <option value="POST">POST</option>
        </select>
      </div>
    </div>

    <div>
      <label>URL</label>
      <input type="text" [(ngModel)]="endpoint.url" placeholder="https://api.example.com/endpoint">
    </div>

    <div class="grid-2">
      <div>
        <label>API Key</label>
        <input type="text" [(ngModel)]="endpoint.apiKey">
      </div>
      <div>
        <label>Request Secret</label>
        <input type="text" [(ngModel)]="endpoint.requestSecret">
      </div>
    </div>
  </div>

  <div class="api-action-row">
    <button type="button" class="cancel" (click)="addEndpoint('auth')">+ Add Auth API</button>
    <button type="button" class="cancel" (click)="addEndpoint('data')">+ Add Data API</button>
  </div>

  <label>Sample Request</label>
  <pre class="code"><code [innerText]="apiSample"></code></pre>

  <div class="api-action-row">
    <button type="button" class="cancel" (click)="save()">Save API Setup</button>
    <button type="button" class="save" [disabled]="pullInProgress" (click)="pullFromApi()">
      {{ pullInProgress ? 'Pulling...' : 'Pull Brand Data' }}
    </button>
  </div>
  <small class="hint" *ngIf="pullMessage">{{ pullMessage }}</small>
</div>

<div class="actions">
  <button class="cancel" (click)="close()">Cancel</button>
  <button class="save" [disabled]="!isSkuValid" (click)="save()">Save</button>
</div>
