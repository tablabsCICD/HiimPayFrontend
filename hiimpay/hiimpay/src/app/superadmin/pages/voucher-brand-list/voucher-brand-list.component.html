<div class="brand-list-root py-5 px-5">
  <div class="page-header">
    <div class="header-left">
      <h2>Brand Listing</h2>
      <div class="subtitle">
        View and manage brand data only
      </div>
    </div>

    <div class="header-right">
      <button mat-stroked-button color="primary" (click)="openAddBrand()">
        + Add Brands
      </button>

      <button mat-stroked-button color="primary" (click)="openUpdateBrand()">
        Update Brands
      </button>
    </div>
  </div>

  <div class="filters">
    <input
      class="search"
      type="text"
      placeholder="Search by Brand Name or Category"
      [(ngModel)]="q"
      (input)="onSearchChange()"
    />

    <div class="simple-filters">
      <select [(ngModel)]="selectedCategory" (change)="setCategory(selectedCategory)">
        <option *ngFor="let category of categoryMenu" [value]="category">
          {{ category === 'ALL' ? 'All Categories' : category }}
        </option>
      </select>

      <label class="in-stock">
        <input
          type="checkbox"
          [(ngModel)]="inStockOnly"
          (change)="setInStock(inStockOnly)"
        />
        In Stock Only
      </label>
    </div>
  </div>

  <div class="table-wrap">
    <div class="table-scroller">
      <table class="brand-table">
        <thead>
          <tr>
            <th></th>
            <th>Brand Name</th>
            <th>Brand SKU</th>
            <th>Category</th>
            <th>Website</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngIf="loading">
            <td colspan="7" class="empty">Loading...</td>
          </tr>

          <tr
            *ngFor="let b of filtered"
            class="data-row clickable"
            (click)="openBrand(b)"
          >
            <td class="logo-td">
              <img *ngIf="b.brandImage" [src]="b.brandImage" />
              <div *ngIf="!b.brandImage" class="logo-placeholder"></div>
            </td>

            <td>
              <div class="brand-name">{{ b.name }}</div>
            </td>

            <td>{{ b.brandSku || '-' }}</td>

            <td>
              <span class="tag" *ngFor="let c of b.categories | slice:0:2">
                {{ c }}
              </span>
              <span *ngIf="b.categories.length > 2">
                +{{ b.categories.length - 2 }} more
              </span>
            </td>

            <td>
              <a
                href="{{ b.onlineRedemptionUrl }}"
                target="_blank"
                (click)="$event.stopPropagation()"
              >
                Visit
              </a>
            </td>

            <td>
              <span
                class="stock-badge"
                [ngClass]="{ in: b.stockAvailable, out: !b.stockAvailable }"
              >
                {{ b.stockAvailable ? 'In Stock' : 'Out of Stock' }}
              </span>
            </td>

            <td>
              <button
                mat-stroked-button
                color="primary"
                (click)="$event.stopPropagation(); openBrandCategoryCoupons(b)"
              >
                View
              </button>
            </td>
          </tr>

          <tr *ngIf="!loading && filtered.length === 0">
            <td colspan="7" class="empty">No brands found</td>
          </tr>

        </tbody>
      </table>
    </div>
  </div>

</div>
